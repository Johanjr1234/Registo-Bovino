<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario Ganadero</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: sans-serif; padding: 15px; background-color: #f4f4f9; max-width: 800px; margin: auto; }
        
        .nav-menu { display: flex; gap: 10px; margin-bottom: 15px; }
        .nav-btn { flex: 1; padding: 12px; text-align: center; background: #fff; color: #333; border-radius: 8px; font-weight: bold; border: 1px solid #ddd; text-decoration: none; }
        .nav-btn.active { background: #2e7d32; color: white; border: none; }

        /* PANEL FINANCIERO DE 3 COLUMNAS */
        .balance-section { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .balance-titulo { text-align: center; color: #333; margin-top: 0; font-size: 1.1em; margin-bottom: 15px;}
        
        .kpi-container { display: flex; gap: 5px; margin-bottom: 15px; }
        .kpi-card { flex: 1; padding: 8px; border-radius: 6px; text-align: center; color: white; }
        
        .kpi-compras { background-color: #d32f2f; } /* Rojo: Salidas */
        .kpi-ventas { background-color: #2e7d32; }  /* Verde: Entradas */
        .kpi-activos { background-color: #1976d2; } /* Azul: Capital Vivo */
        
        .kpi-valor { display: block; font-size: 0.9em; font-weight: bold; margin-top: 5px; word-wrap: break-word;}
        .kpi-label { font-size: 0.7em; opacity: 0.9; text-transform: uppercase; }

        .grafico-container { position: relative; height: 220px; width: 100%; }

        /* FILTROS */
        .filtros { display: flex; gap: 5px; margin-bottom: 15px; background: #e0e0e0; padding: 5px; border-radius: 8px; }
        .btn-filtro { flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #666; border-radius: 5px; }
        .btn-filtro.seleccionado { background: white; color: #2e7d32; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }

        /* TARJETAS */
        .animal-card { border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; border-radius: 10px; background-color: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .animal-header { display: flex; align-items: center; cursor: pointer; gap: 12px; }
        .cow-thumb { width: 55px; height: 55px; border-radius: 50%; object-fit: cover; border: 2px solid #2e7d32; }
        .no-thumb { width: 55px; height: 55px; border-radius: 50%; background: #eee; display: flex; align-items: center; justify-content: center; font-size: 24px; border: 2px solid #ddd; }
        
        .info-resumen { flex: 1; }
        .nombre-animal { font-weight: 800; font-size: 1.1em; color: #333; display: block; }
        .raza-animal { font-size: 0.9em; color: #666; }
        .age-badge, .sold-badge { padding: 3px 8px; border-radius: 12px; font-size: 0.75em; font-weight: bold; color: white; }
        .age-badge { background-color: #f0ad4e; }
        .sold-badge { background-color: #455a64; } /* Gris oscuro para vendidos */

        /* ETIQUETAS DE UTILIDAD (NUEVO) */
        .profit-badge { display: block; margin-top: 5px; padding: 5px; border-radius: 4px; font-weight: bold; text-align: center; font-size: 0.9em; }
        .profit-positive { background-color: #e8f5e9; color: #2e7d32; border: 1px solid #a5d6a7; }
        .profit-negative { background-color: #ffebee; color: #c62828; border: 1px solid #ef9a9a; }

        .animal-details { display: none; padding-top: 15px; border-top: 1px dashed #eee; margin-top: 10px; }
        .foto-grande { max-width: 100%; border-radius: 8px; margin: 10px auto; display: block; }

        .offspring-container { background-color: #f1f8e9; border: 1px solid #c5e1a5; border-radius: 8px; padding: 10px; margin-top: 10px; }
        .mini-cria-card { background: white; border-radius: 6px; border: 1px solid #dcedc8; margin-bottom: 8px; overflow: hidden; }
        .mini-header { display: flex; align-items: center; gap: 10px; padding: 8px; cursor: pointer; }
        .mini-thumb { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 1px solid #ccc; }
        .mini-actions { display: none; padding: 8px; background: #f9f9f9; border-top: 1px solid #eee; display: flex; gap: 5px; }

        .acciones { display: flex; gap: 10px; margin-top: 15px; }
        .btn-accion, .btn-mini { border: none; border-radius: 5px; font-weight: bold; cursor: pointer; color: white; }
        .btn-accion { flex: 1; padding: 10px; font-size: 0.9em; }
        .btn-mini { flex: 1; padding: 6px; font-size: 0.8em; }
        .btn-vender { background-color: #f57f17; }
        .btn-editar { background-color: #1976d2; }
        .btn-eliminar { background-color: #d32f2f; }
    </style>
</head>
<body>
    <nav class="nav-menu">
        <a href="index.html" class="nav-btn">üìù Registro</a>
        <a href="inventario.html" class="nav-btn active">üìã Inventario</a>
    </nav>

    <div class="balance-section">
        <h3 class="balance-titulo">üìä Balance y Patrimonio</h3>
        <div class="kpi-container">
            <div class="kpi-card kpi-compras">
                <span class="kpi-label">Gastos Totales</span>
                <span id="total-compras" class="kpi-valor">$0</span>
            </div>
            <div class="kpi-card kpi-activos">
                <span class="kpi-label">Ganado en Finca</span>
                <span id="total-activos" class="kpi-valor">$0</span>
            </div>
            <div class="kpi-card kpi-ventas">
                <span class="kpi-label">Ventas Totales</span>
                <span id="total-ventas" class="kpi-valor">$0</span>
            </div>
        </div>
        <div class="grafico-container">
            <canvas id="balanceChart"></canvas>
        </div>
    </div>

    <div class="filtros">
        <button id="btn-finca" class="btn-filtro seleccionado" onclick="cambiarFiltro(false)">üêÆ En Finca</button>
        <button id="btn-historial" class="btn-filtro" onclick="cambiarFiltro(true)">üí∞ Historial Ventas</button>
    </div>

    <div id="inventario-listado">
        <p style="text-align: center;">Cargando...</p>
    </div>

    <script type="module" src="app.js"></script>
    <script>
        function cambiarFiltro(verHistorial) {
            document.getElementById('btn-finca').className = verHistorial ? 'btn-filtro' : 'btn-filtro seleccionado';
            document.getElementById('btn-historial').className = verHistorial ? 'btn-filtro seleccionado' : 'btn-filtro';
            window.cargarInventario(verHistorial);
        }
    </script>
</body>
</html>
